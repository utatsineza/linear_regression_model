import joblib
import numpy as np
from sklearn.metrics import mean_squared_error

# Compute RMSE for each model
rmse_scores = {
    'Linear Regression': np.sqrt(mean_squared_error(y_test, lr_model.predict(X_test))),
    'Decision Tree': np.sqrt(mean_squared_error(y_test, dt_model.predict(X_test))),
    'Random Forest': np.sqrt(mean_squared_error(y_test, rf_model.predict(X_test)))
}

# Select the best model (lowest RMSE)
best_model_name = min(rmse_scores, key=rmse_scores.get)
print("Best Model:", best_model_name)

if best_model_name == 'Linear Regression':
    best_model = lr_model
elif best_model_name == 'Decision Tree':
    best_model = dt_model
else:
    best_model = rf_model

# SAVE BEST MODEL HERE
joblib.dump(best_model, 'best_yield_model.pkl')
print("Best model saved as 'best_yield_model.pkl'")
